<html><head><title>FRESHKILLS</title></head><body>

<img style="float: right;" height="350" src="horseshoe.png">
<h1>F R E S H K I L L S</h1>

<form action="dummy" id="form" method="get">
<textarea id="txt" style="width: 60%;"></textarea><br>
<input type="submit" id="submit" value="kill"></input>
</form>

<h2>killed</h2>
<div id="killed"></div>

<p>&nbsp;<p>
<div id="foot"><a href="https://github.com/jli/freshkills">src.</a> <small>&copy; 2011 <a href="http://circularly.org/">jli</a> <a href="http://sam.zoy.org/wtfpl/COPYING">WTFPL</a></small></div>

<!--<script src="freshkills.js"></script>-->
<script>
function get(id) { return document.getElementById(id); }
function out(txt) { get('killed').innerHTML=txt; }
function xhr_ready(xhr) {
  return (xhr.readyState==4 && xhr.status==200);
}

function load_posts() {
  var xhr = new XMLHttpRequest();
  xhr.open("GET", "/get", true);
  xhr.onreadystatechange=function() {
    if (xhr_ready(xhr)) {
      out(xhr.responseText);
    }
  };
  xhr.send();
}

function post() {
  //freshkills.main.post('yar');
  var xhr = new XMLHttpRequest();
  xhr.open("POST", "/post", true);
  xhr.onreadystatechange=function() {
    if (xhr_ready(xhr)) {
      load_posts();
    }
  }
  xhr.send(get('txt').value);
  return false; // prevent form submission
}

load_posts();
get('form').onsubmit=post;
</script>
</body></html>
